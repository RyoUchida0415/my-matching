<%= render 'users/header' %>

<div class="col-md-3">
	<%= render 'users/sidebar', user: current_user %>
</div>

<div class="col-md-9">
	<!--カレントユーザならマイページ-->
	<% if user_signed_in? && @user == current_user %>
	<h1>マイページ</h1>
	<!--他のユーザなら会員詳細-->
	<% else %>
	<h1>会員詳細</h1>
	<% end %>

	<!--会員情報-->
	<%= attachment_image_tag @user, :image,format:'jpeg', fallback: "no_image.jpg", size:'300x300'  %>
	<div>

		<%= @user.nickname %>
		<%= @user.age %>歳
		<%= @user.prefecture %>
		<%= @user.introduction %>

		<!-- フォローボタン -->
		<% if @current_user != @user %>
			<% if current_user.following?(@user) %>
				<%= link_to 'フォロー外す', user_relationships_path(@user.id), method: :delete, class: "btn btn-primary" %>
			<% else %>
				<%= link_to 'フォローする', user_relationships_path(@user.id), method: :POST, class: "btn btn-success" %>
			<% end %>
		<% end %>

		<!--メッセージボタン-->
		<!--現在ログインしているユーザーでないならば-->
		<% unless @user.id == current_user.id %>
			<!--相互フォローーしているならば-->
			<% if (current_user.following?(@user)) && (@user.following? (current_user))  %>
				<!--チャットルームが存在しているならば-->
				<% if @isRoom == true %>
					<%= link_to 'メッセージを送る',room_path(@roomId),class: "btn btn-primary" %>
				<!--チャットルームが存在していないならば-->
				<% else %>
					<%= form_for @room do |f| %>
						<%= fields_for @entry do |entry| %>
							<%= entry.hidden_field :user_id, :value=> @user.id %>
						<% end %>
							<%= f.submit "チャットを始める",class: "btn btn-primary" %>
					<% end %>
				<% end %>
			<% end %>
		<% end %>
	</div>

	<!-- 投稿ブログ一覧 -->
	<h2>ブログ</h2>
		<div class="blog body">
			<% @blogs.each do |blog| %>
				<%= blog.created_at.strftime('%Y/%m/%d') %>
				<%= blog.blog %>
			<% end %>
		</div>

</div>